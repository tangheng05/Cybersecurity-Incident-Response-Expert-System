{% extends "layouts/base.html" %} {% block title %}{{ rule.name }}{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h1 class="h3">Rule Details</h1>
  <div>
    {% if session.role in ['admin', 'analyst'] %}
    <a
      href="{{ url_for('rules.edit', rule_id=rule.id) }}"
      class="btn btn-sm btn-outline-secondary"
      >Edit</a
    >
    {% endif %}
    <a
      href="{{ url_for('rules.index') }}"
      class="btn btn-sm btn-outline-primary"
      >Back to List</a
    >
  </div>
</div>

<div class="card shadow-sm">
  <div class="card-header bg-primary text-white">
    <h4 class="mb-0">{{ rule.name }}</h4>
  </div>
  <div class="card-body">
    <dl class="row">
      <dt class="col-sm-3">Rule ID</dt>
      <dd class="col-sm-9">{{ rule.id }}</dd>

      <dt class="col-sm-3">Attack Type</dt>
      <dd class="col-sm-9">
        <span class="badge bg-info"
          >{{ rule.attack_type.name.replace('_', ' ').title() }}</span
        >
      </dd>

      <dt class="col-sm-3">Priority</dt>
      <dd class="col-sm-9">
        {% if rule.priority == 'high' %}
        <span class="badge bg-danger">High</span>
        {% elif rule.priority == 'medium' %}
        <span class="badge bg-warning text-dark">Medium</span>
        {% else %}
        <span class="badge bg-secondary">Low</span>
        {% endif %}
      </dd>

      <dt class="col-sm-3">Severity Score</dt>
      <dd class="col-sm-9">
        <span class="badge bg-dark">{{ rule.severity_score }}/10</span>
      </dd>

      <dt class="col-sm-3">Status</dt>
      <dd class="col-sm-9">
        {% if rule.is_active %}
        <span class="badge bg-success">Active</span>
        {% else %}
        <span class="badge bg-secondary">Inactive</span>
        {% endif %}
      </dd>

      <dt class="col-sm-3">Conditions</dt>
      <dd class="col-sm-9">
        <pre
          class="bg-light p-3 rounded"
        ><code>{{ rule.conditions|tojson(indent=2) }}</code></pre>
      </dd>

      <dt class="col-sm-3">Actions</dt>
      <dd class="col-sm-9">
        <ul class="list-group">
          {% for action in rule.actions %}
          <li class="list-group-item">{{ action }}</li>
          {% endfor %}
        </ul>
      </dd>

      <dt class="col-sm-3">Created</dt>
      <dd class="col-sm-9">
        {{ rule.created_at.strftime('%Y-%m-%d %H:%M:%S') }}
      </dd>

      <dt class="col-sm-3">Last Updated</dt>
      <dd class="col-sm-9">
        {{ rule.updated_at.strftime('%Y-%m-%d %H:%M:%S') }}
      </dd>
    </dl>
  </div>
</div>

<div class="mt-3">
  <div class="card">
    <div class="card-header bg-secondary text-white">
      <h5 class="mb-0">Attack Type Information</h5>
    </div>
    <div class="card-body">
      <p>
        <strong>Name:</strong> {{ rule.attack_type.name.replace('_', '
        ').title() }}
      </p>
      <p>
        <strong>Description:</strong> {{ rule.attack_type.description or 'N/A'
        }}
      </p>
      <p>
        <strong>Severity Level:</strong>
        <span class="badge bg-dark"
          >{{ rule.attack_type.severity_level }}/10</span
        >
      </p>
    </div>
  </div>
</div>
{% endblock %}
