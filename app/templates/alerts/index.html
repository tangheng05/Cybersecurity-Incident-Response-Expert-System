{% extends "layouts/base.html" %} 
{% block title %}Security Alerts - Cybersecurity Expert System{% endblock %} 

{% block extra_css %}
<style>
  .filter-tabs-container {
    display: inline-flex;
    gap: 8px;
  }
  
  .filter-tab {
    padding: 10px 24px;
    border-radius: 6px;
    text-decoration: none;
    font-weight: 600;
    font-size: 0.9rem;
    transition: all 0.2s ease;
    background: var(--card-bg);
    color: var(--text-secondary);
    border: 1px solid var(--card-border);
    display: inline-flex;
    align-items: center;
    white-space: nowrap;
  }
  
  .filter-tab.active {
    background: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
    box-shadow: var(--shadow-sm);
  }
  
  .filter-tab:not(.active):hover {
    background: var(--hover-bg);
    color: var(--text-primary);
    border-color: var(--card-border);
  }
  
  .filter-tab i {
    font-size: 0.85rem;
  }
</style>
{% endblock %}

{% block content %}

<!-- Page Header -->
<div class="mb-5">
  <div class="d-flex justify-content-between align-items-center">
    <div>
      <h1 class="h2 mb-2" style="font-weight: 700; color: var(--text-primary)">
        <i class="fas fa-shield-alt me-3" style="color: #0d6efd;"></i>Security Alerts
      </h1>
      <p class="mb-0" style="color: var(--text-secondary); font-size: 1rem">
        Monitor and manage security alerts across your infrastructure
      </p>
    </div>
    <a
      href="{{ url_for('alerts.create') }}"
      class="btn btn-primary"
      style="border-radius: 8px; padding: 0.65rem 1.5rem; font-weight: 500; box-shadow: 0 2px 6px rgba(13,110,253,0.3);"
    >
      <i class="fas fa-plus-circle me-2"></i>Submit Alert
    </a>
  </div>
</div>

<!-- Filter Tabs -->
<div class="mb-4">
  <div class="filter-tabs-container">
    <a
      href="{{ url_for('alerts.index') }}"
      class="filter-tab {% if not current_filter %}active{% endif %}"
    >
      <i class="fas fa-list me-2"></i>All Alerts
    </a>
    <a
      href="{{ url_for('alerts.index', status='processed') }}"
      class="filter-tab {% if current_filter == 'processed' %}active{% endif %}"
    >
      <i class="fas fa-check-circle me-2"></i>Processed
    </a>
    <a
      href="{{ url_for('alerts.index', status='ignored') }}"
      class="filter-tab {% if current_filter == 'ignored' %}active{% endif %}"
    >
      <i class="fas fa-times-circle me-2"></i>Ignored
    </a>
  </div>
</div>

  {% if alerts %}
  <div class="table-responsive">
    <table class="table table-striped table-hover">
      <thead class="table-dark">
        <tr>
          <th>ID</th>
          <th>Timestamp</th>
          <th>Source IP</th>
          <th>Alert Type</th>
          <th>Severity</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for alert in alerts %}
        <tr>
          <td>#{{ alert.id }}</td>
          <td>{{ alert.timestamp.strftime('%Y-%m-%d %H:%M:%S') }}</td>
          <td><code>{{ alert.source_ip }}</code></td>
          <td>{{ alert.alert_type }}</td>
          <td>
            <span
              class="badge bg-{% if alert.severity == 'critical' %}danger{% elif alert.severity == 'high' %}warning{% elif alert.severity == 'medium' %}info{% else %}secondary{% endif %}"
            >
              {{ alert.severity.upper() }}
            </span>
          </td>
          <td>
            <span
              class="badge bg-{% if alert.status == 'new' %}primary{% elif alert.status == 'processed' %}success{% else %}secondary{% endif %}"
            >
              {{ alert.status.upper() }}
            </span>
          </td>
          <td>
            <a
              href="{{ url_for('alerts.detail', alert_id=alert.id) }}"
              class="btn btn-sm btn-outline-primary"
            >
              <i class="bi bi-eye"></i> View
            </a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
  <div class="alert alert-info">
    <i class="bi bi-info-circle"></i> No alerts found. {% if current_filter %}
    <a href="{{ url_for('alerts.index') }}">View all alerts</a>
    {% else %}
    <a href="{{ url_for('alerts.create') }}">Submit your first alert</a>
    {% endif %}
  </div>
  {% endif %}
</div>
{% endblock %}
